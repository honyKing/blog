<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="SysInternals 工具系列, 宅世界">
    <meta name="description" content="微软的系统工具(sysinternals)使用介绍,着重 psexec">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>SysInternals 工具系列 | 宅世界</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    
    <script src="/libs/jquery/jquery.min.js"></script>
    
<meta name="generator" content="Hexo 4.2.1"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="../../../../index.html" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">宅世界</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/Other/index.html" class="waves-effect waves-light">
      
      <i class="fas fa-vial"" style="zoom: 0.6;"></i>
      
      <span>实验室</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">宅世界</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/Other/index.html" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-vial""></i>
			
			实验室
		</a>
          
        </li>
        
        
    </ul>
</div>

        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '../../../../index.html';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/16.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">SysInternals 工具系列</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="../../../../tags/Windows/">
                                <span class="chip bg-color">Windows</span>
                            </a>
                        
                            <a href="../../../../tags/%E7%AC%94%E8%AE%B0/">
                                <span class="chip bg-color">笔记</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2019-10-15
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2020-04-20
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    3.4k
                </div>
                

                
				
                
            </div>
            
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="官方介绍下载地址"><a href="#官方介绍下载地址" class="headerlink" title="官方介绍下载地址"></a>官方介绍下载地址</h2><blockquote>
<p><a href="https://docs.microsoft.com/en-us/sysinternals/" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/sysinternals/</a></p>
</blockquote>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>如果你发现你的命令输入没有错误,但是总是提示 “<br>The network path was not found.” ,那你需要执行下面的命令行之后,即可正常执行 sysinternals 的工具</p>
<pre><code>To start the Remote Registry service via a command line:

&gt; sc start RemoteRegistry

To have it start automatically every time:

&gt; sc config RemoteRegistry start=auto

(重要)To do this to a remote machine named Desktop1:

&gt; sc \\Desktop1 config RemoteRegistry start=auto</code></pre><h2 id="PsTools"><a href="#PsTools" class="headerlink" title="PsTools"></a>PsTools</h2><p>PSTools 本身就有十来个<code>命令行</code>小工具</p>
<pre><code>PsExec – 在远程计算机执行命令
PsFile – 查看打开的网络文件
PsGetSid – 获取 Machine SID
PsInfo – 查看简要系统信息
PsKill – 按进程名或PID杀掉进程
PsList – 列出进程信息
PsLoggedOn – 显示已登的会话
PsLogList – 命令行获取 event log
PsPasswd – 更改用户密码
PsPing – 简单的tcp/udp连接测试工具
PsService – Windows 服务管理命令
PsShutdown – 关机、注销命令
PsSuspend – 暂停或恢复某个进程</code></pre><p>以上所有命令都可以直接在本地计算机上使用，不过 PsTools 设计出来就是为了方便对远程 PC 进行管理的</p>
<p>PsTools 所有工具连接远程计算机都可以使用同一个通用语法，例如：</p>
<pre><code>psinfo \\pc1,pc2,pc3</code></pre><p>双斜杠后面可以直接跟计算机名（可以解析netbios）、IP 地址或 FQDN，也可以在命令后跟多台计算机以实现批量</p>
<p>如果你不是以域管理员等有权限的用户来执行命令、没有域环境或者需要手动指定有权限的远程用户，可用 -u 参数指定用户，-p 参数指定密码 </p>
<p>如果是域环境，需要将用户写为 <code>DOMAIN\user</code> 样式</p>
<pre><code>psinfo \\computername –u user –p Password</code></pre><h3 id="PsExec"><a href="#PsExec" class="headerlink" title="PsExec"></a>PsExec</h3><p>PsExec 是 PsTools 工具系列中最为常用的一个命令行工具，它可以让我们在本地或远程计算机上「运行」任何东西，包括更改注册表、执行脚本或应用程序等。</p>
<h4 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h4><ul>
<li><p>命令说明:</p>
<pre><code>psexec \\计算机名 &lt;选项&gt; apptorun.exe &lt;参数&gt;</code></pre></li>
<li><p>例如你想查看某个远程计算机的 TCP/IP 配置，可以使用如下命令：</p>
<pre><code>psexec \\计算机名 -u User -p Password ipconfig</code></pre></li>
<li><p>如果你将命令输出重定向到一个文件中，可以使用常见的 command.exe &gt; output.txt 方式，这种方式对 PsExec 命令同样适用，例如我们可以使用类似如下命令将 netstat -an 的输出保存到本地文本文件中：</p>
<pre><code>psexec \\计算机名 netstat -an &gt; C:\netstat.txt</code></pre></li>
<li><p>如果你想将命令的重定向输出结果直接保存到远程 PC 当中，可以使用很少有人知道的 ^ 这个Windows 命令行转义符，例如：</p>
<pre><code>psexec \\计算机名 cmd /c netstat -an ^&gt; C:\users\sysgeek\netstat.txt</code></pre></li>
<li><p>有时我们需要执行的 CDM 外部命令并没有存在于远程计算机当中，此时我们可以使用 PsExec 的 -c 参数来指定一个存放于管理员本地的外部命令或应用。当我们执行命令时，PsExec 会自动将所指定的应用复制到远程 PC 中执行，并在执行完成后自动删除。例如</p>
<pre><code>psexec \\计算机名 -c autorunsc.exe –accepteula</code></pre></li>
<li><p>跳过第一次打开软件的条款同意声明</p>
<pre><code>psexec /accepteula</code></pre></li>
<li><p>如果不指定密码,命令行里面会让你输入密码</p>
<pre><code>D:\runsoftware\SysinternalsSuite\PsExec.exe \\192.168.1.102 -u ieuser netstat -na</code></pre><p><img src="6.png" alt=""></p>
</li>
<li><p>Maybe you need to bring up a notepad window on a remote computer. Not a problem. Run notepad.exe with the -i switch and PsExec will open up Notepad.</p>
<pre><code>psexec -i \\REMOTECOMPUTER notepad</code></pre></li>
</ul>
<ul>
<li>Be sure to also use the <code>-d</code> switch to disconnect when the interactive window is brought up though. By default, PsExec will wait for the process it executed to complete. If the remote process (Notepad in this case) is kept running, PsExec will never return control.</li>
</ul>
<ul>
<li><p><strong>像linux的ssh一样使用,远程Windows</strong></p>
<pre><code>psexec \\wss11 -u 666 -p general   cmd</code></pre></li>
<li><p><strong>Do NOT use Ctrl-C to close out of an interactive cmd session. Always use <code>exit</code>. If you use Ctrl-C, the psexec session will remain running on the remote computer.</strong></p>
</li>
</ul>
<h4 id="psexec-给远程电脑安装软件"><a href="#psexec-给远程电脑安装软件" class="headerlink" title="psexec 给远程电脑安装软件"></a>psexec 给远程电脑安装软件</h4><pre><code>psexec \\192.168.2.223  -u administrator  -p &quot;&quot; -c  D:\download\Apache_OpenOffice_4.1.7_Win_x86_install_en-US.exe  /S /v /qb
</code></pre><ul>
<li><code>-p &quot;&quot;</code> 表示密码为空</li>
<li><code>-c</code> 表示复制文件到远程电脑</li>
<li><code>D:\download\Apache_OpenOffice_4.1.7_Win_x86_install_en-US.exe</code>  这个文件是本地电脑的</li>
<li><code>/S /v /qb</code> 表示OpenOffice静默安装参数</li>
</ul>
<p>——————目前该命令存在的问题——————–</p>
<p>使用该命令只能使用远程电脑(目标电脑)的administrator账号,即使用administrators组里面的账号也没有用.不然会提示如下错误:</p>
<pre><code>PsExec could not start Apache_OpenOffice_4.1.7_Win_x86_install_en-US.exe on 192.168.2.223:
The system cannot find the file specified.</code></pre><p>目前只知道, 执行上面那个命令后,Openoffice 会被 复制到远程计算机的<code>c:\windows</code> 目录,执行完成之后文件即被删除</p>
<h4 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h4><ul>
<li><p>打开远程机器的IE浏览器</p>
<pre><code>PsExec.exe \\192.168.1.102 -u ieuser -p general -d -i  &quot;C:\Program Files (x86)\Internet Explorer\iexplore.exe&quot;</code></pre><ul>
<li><code>-d</code> 表示不等待远端机器执行的结果,命令发送后就立即返回</li>
<li><code>-i</code> 在远程端口开启互动界面(GUI).没有这个参数,你在远程机器上是看不到IE浏览器的,只有后台有一个进程而已</li>
<li>后面的IE路径,因为有空格,需要加上双引号</li>
</ul>
<p>下图为有无参数-d的区别(两个命令都成功打开了IE)<br><img src="1.png" alt=""></p>
</li>
<li><p>notepad打开文本<br>如下两种写法都是可以的:<br>  <img src="2.png" alt=""></p>
</li>
</ul>
<pre><code>D:\runsoftware\SysinternalsSuite\PsExec.exe \\192.168.1.102 -u ieuser -p general -d -w C:\runsoftwares -i notepad psexecTest.bat

D:\runsoftware\SysinternalsSuite\PsExec.exe \\192.168.1.102 -u ieuser -p general -d -i notepad  C:\runsoftwares\psexecTest.vbs</code></pre><p>参考</p>
<blockquote>
<p><a href="https://blog.xuite.net/jyoutw/xtech/24607577-PsTools+%E4%B9%8B+PsExec+%E7%9A%84%E7%94%A8%E6%B3%95" target="_blank" rel="noopener">https://blog.xuite.net/jyoutw/xtech/24607577-PsTools+%E4%B9%8B+PsExec+%E7%9A%84%E7%94%A8%E6%B3%95</a></p>
</blockquote>
<h4 id="运行远程pc上的vbs脚本报错"><a href="#运行远程pc上的vbs脚本报错" class="headerlink" title="运行远程pc上的vbs脚本报错"></a>运行远程pc上的vbs脚本报错</h4><p>运行bat没有问题,但是vbs会出现<code>The system cannot find the file specified.</code>报错.在不同的电脑测试均出现此问题.目前找不到原因<br> <img src="3.png" alt=""></p>
<p>目前找到该问题的解法,感谢大佬的指路.据说是PATH里找不到执行的文件<br>在命令里加上 <code>wscript</code> 就行</p>
<pre><code>D:\runsoftware\SysinternalsSuite\PsExec.exe \\192.168.1.102 -u ieuser -p general wscript  C:\Users\bingfeng\Documents\script\vbs\psexecTest.vbs</code></pre><h4 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h4><pre><code>-a     
Separate processors on which the application can run with commas where 1 is the lowest numbered CPU. For example, to run the application on CPU 2 and CPU 4, enter: &quot;-a 2,4&quot;

-c     
Copy the specified program to the remote system for execution. If you omit this option the application must be in the system path on the remote system.

-d     
Don&#39;t wait for process to terminate (non-interactive).

-e     
Does not load the specified account&#39;s profile.

-f     
Copy the specified program even if the file already exists on the remote system.

-i     
Run the program so that it interacts with the desktop of the specified session on the remote system. If no session is specified the process runs in the console session. Some have reported best results always using the -s switch with -i due to windows being unintelligible.

-h     
If the target system is Vista or higher, has the proc

-l     
Run process as limited user (strips the Administrators group and allows only privileges assigned to the Users group). On Windows Vista the process runs with Low Integrity.

-n     
Specifies timeout in seconds connecting to remote computers.

-p 
Specifies optional password for user name. If you omit this you will be prompted to enter a hidden password.

-r     
Specifies the name of the remote service to create or interact. with.

-s     
Run the remote process in the System account.

-u     
Specifies optional user name for login to computer.

-v     
Copy the specified file only if it has a higher version number or is newer on than the one on the remote system.

-w    
设置进程的工作目录（相对于远程计算机）

-x     
Display the UI on the Winlogon secure desktop (local system only).

-arm     Specifies the remote computer is of ARM architecture.

-priority     
Specifies -low, -belownormal, -abovenormal, -high or  -realtime

-realtime     
run the process at a different priority. Use

-background     
run at low memory and I/O priority on Vista.

computer     
Direct PsExec to run the application on the computer or computers specified. If you omit the computer name PsExec runs the application on the local system, and if you specify a wildcard (\*), PsExec runs

@file     
PsExec will execute the command on each of the computers listed in the file.

-accepteula     
This flag suppresses the display of the license dialog.

-nobanner     
Do not display the startup banner and copyright message.</code></pre><h4 id="psexec-工作原理"><a href="#psexec-工作原理" class="headerlink" title="psexec 工作原理"></a>psexec 工作原理</h4><p>How PsExec Works on Remote Computers</p>
<p>PsExec goes through a few steps to execute programs on remote computers.</p>
<ul>
<li><p>Create a PSEXESVC.exe file in C:\Windows.</p>
</li>
<li><p>Create and start a Windows service on the remote computer called PsExec.</p>
</li>
<li><p>Execute the program under a parent process of psexesvc.exe.</p>
</li>
<li><p>When complete, the PsExec Windows service will be stopped and removed.</p>
<p>When the process doesn’t work 100% correctly you may have to manually remove the service using the sc command.</p>
</li>
</ul>
<blockquote>
<p> <a href="https://blog.51cto.com/leomars/1900528" target="_blank" rel="noopener">https://blog.51cto.com/leomars/1900528</a></p>
</blockquote>
<h3 id="PsFile"><a href="#PsFile" class="headerlink" title="PsFile"></a>PsFile</h3><ul>
<li>psfile 命令可以显示本地或远程 PC 中通过网络打开的文件，其类似于命令行中的 net file 命令，及 NetworkOpenedFiles 图形界面工具<pre><code>psfile \\计算机名</code></pre></li>
</ul>
<ul>
<li>如果你想中断某个共享的访问连接，可以使用 -c 参数：<pre><code>psfile \\计算机名 &lt;路径&gt; –c</code></pre></li>
</ul>
<h3 id="PsInfo"><a href="#PsInfo" class="headerlink" title="PsInfo"></a>PsInfo</h3><p>PsInfo 主要用于显示 Windows 操作系统版本、系统运行时长及个别硬件的简单信息，如果你想获取更详尽的信息，可以使用 -d（磁盘信息）、-h（补丁信息）、-s（已知应用程序版本列表）参数，这样一来就比较像 Windows 内置的 systeminfo 命令行了。</p>
<pre><code>psinfo -d -h -s</code></pre><h3 id="PsKill"><a href="#PsKill" class="headerlink" title="PsKill"></a>PsKill</h3><p>PsKill 看名称就不难猜，它可按进程名或 PID 结束进程，使用 -t 参数可以杀掉整个进程树。</p>
<pre><code>pskill \\计算机名 </code></pre><h3 id="PsList"><a href="#PsList" class="headerlink" title="PsList"></a>PsList</h3><p>它可以通过列表方式看到进程的几乎所有信息，包括线程数</p>
<h3 id="PsLoggedOn"><a href="#PsLoggedOn" class="headerlink" title="PsLoggedOn"></a>PsLoggedOn</h3><p>PsLoggedOn 命令主要用于查看本地或远程 PC 上当前登录的用户信息，对于系统管理员来说非常实用。</p>
<h3 id="PsPing"><a href="#PsPing" class="headerlink" title="PsPing"></a>PsPing</h3><p>PsPing 是一个可对指定端口进行 TCP 或 UDP 连接测试的工具</p>
<h3 id="PsPasswd"><a href="#PsPasswd" class="headerlink" title="PsPasswd"></a>PsPasswd</h3><p>PsPasswd 用于快速更改本地或远程 PC 的用户密码</p>
<p>该命令相较 net user 的好处在于可以一次性批量修改多台计算机的密码，对于域管理员批量重置某些本地账户密码时非常有用</p>
<pre><code>pspasswd \\计算机名 -u User -p Password &lt;账户名称&gt; &lt;新密码&gt;</code></pre><h3 id="PsSuspend"><a href="#PsSuspend" class="headerlink" title="PsSuspend"></a>PsSuspend</h3><p>该命令行工具与 PsKill 比较类似但不是杀掉进程，它主要用于暂停某个进程的工作</p>
<p>要将已暂停的进程恢复到工作状态，只需加上 -r 参数即可</p>
<pre><code>pssuspend \\计算机名 &lt;PID或进程名&gt;</code></pre><h3 id="PsService"><a href="#PsService" class="headerlink" title="PsService"></a>PsService</h3><p>PsService 命令行工具可操作 Windows 中的各种服务，其语法如下</p>
<pre><code>psservice \\计算机名 &lt;操作&gt; &lt;服务名&gt;</code></pre><p>用的操作有start（启动）、stop（停止）、pause（暂停）、restart（重启），要查看详细参数可以使用 PsService /?</p>
<h2 id="TCPView"><a href="#TCPView" class="headerlink" title="TCPView"></a>TCPView</h2><p>TCPView 是用于查看当前 Windows 应用程序和服务连网状态的绝佳工具，通过它我们可以在图形界面中查看到类似使用 netstat 命令输出的大部分信息。</p>
<p>与其它 Sysinternals 工具的颜色标识类似，绿色条目表示刚建立连接、红色表示连接正在关闭，而黄色则表示更改了连接指向</p>
<h2 id="RamMap"><a href="#RamMap" class="headerlink" title="RamMap"></a>RamMap</h2><p>RamMap 工具主要用于分析物理内存的使用情况，它以可视化的图形界面进行输出显示。在 RamMap 界面中，你可以查看到非常详细的内存用量，例如：空闲内存、页面缓冲池、非页面缓冲池、已提交和已缓存等条目的详细情况，比任务管理器中的内存显示强大多了。</p>
<h2 id="Autologon"><a href="#Autologon" class="headerlink" title="Autologon"></a>Autologon</h2><p>Autologon 可以快速实现Windows自动登录（有登录密码情况下）<br>在打开之后，只需输入要用于自动登录的账户和密码即可。</p>
<p>其它自动登录的方法</p>
<blockquote>
<p><a href="http://www.sysgeek.cn/auto-login-windows-10/" target="_blank" rel="noopener">http://www.sysgeek.cn/auto-login-windows-10/</a></p>
</blockquote>
<h2 id="AccessEnum"><a href="#AccessEnum" class="headerlink" title="AccessEnum"></a>AccessEnum</h2><p>AccessEnum 是我在做文件夹权限排错时最常用的一个工具，在我们对某个文件夹进行过复杂的权限配置后，AccessEnum 工具可以非常容易帮助我们理清文件夹或注册表的最终访问控制列表。</p>
<h2 id="SigCheck"><a href="#SigCheck" class="headerlink" title="SigCheck"></a>SigCheck</h2><p>SigCheck 命令行工具最常用的是 -u 参数，它只报告有问题的文件；-e 参数表示只对可执行文件进行检查。所以，我们可以使用如下命令对 C:\Windows\System32 （或某个其它）文件夹进行快速检查：</p>
<pre><code>sigcheck -e -u C:\Windows\System32</code></pre><p>在发现异常文件时，可以使用 -v 参数开启 VirusTotal 校验</p>
<pre><code>sigcheck -v -vt &lt;文件名&gt;</code></pre><h2 id="Contig"><a href="#Contig" class="headerlink" title="Contig"></a>Contig</h2><pre><code>contig &lt;文件名&gt;</code></pre><p>如果你要分析一个文件的碎片而不实际整理，可以使用 -a 参数</p>
<h2 id="du"><a href="#du" class="headerlink" title="du"></a>du</h2><p>而 du 是 Sysinternals 套件中的命令行磁盘和文件夹大小查看工具。du 命令行工具的存在主要是因为其显示更为准确，而且在计算空间时不会计数符号链接文件</p>
<p>其中 -n 参数在统计大小时不递归在子文件夹，-v 参数将详细列表显示子文件夹大小（KB），-l 参数可以单独控制子文件夹递归层级（默认为 1）</p>
<h2 id="Disk2vhd"><a href="#Disk2vhd" class="headerlink" title="Disk2vhd"></a>Disk2vhd</h2><p>Disk2vhd 小工具可将正在运行计算机的磁盘克隆成 VHD 虚拟磁盘文件，因此它也成为不少虚拟化项目中的 P2V 转换工具</p>
<h2 id="autoruns"><a href="#autoruns" class="headerlink" title="autoruns"></a>autoruns</h2><pre><code>粉红色：表示该条目对应的应用没有数字签名、签名不匹配或没有发行商信息
黄色：表示该启动条目对应的文件已经不存在了
绿色：该功能不太常用，简单来说就是我们可以在使用 File — Save 对启动项目进行导出成 .arn 格式进行存储，之后有可能在 Autoruns 里面对启动条目进行了配置，然后再在 File — Compare 里面载入之前导出的 .arn 文件即可对不同时间和状态下 Windows 启动条目进行对比，对比出来的差异将以绿色高亮进行显示。</code></pre><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><blockquote>
<p><a href="https://www.sysgeek.cn/?s=SysInternals%E7%B3%BB%E5%88%97" target="_blank" rel="noopener">https://www.sysgeek.cn/?s=SysInternals%E7%B3%BB%E5%88%97</a></p>
</blockquote>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://blog.bingfeng.ml" rel="external nofollow noreferrer">ROOT</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://blog.bingfeng.ml">https://blog.bingfeng.ml</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://blog.bingfeng.ml" target="_blank">ROOT</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="../../../../tags/Windows/">
                                    <span class="chip bg-color">Windows</span>
                                </a>
                            
                                <a href="../../../../tags/%E7%AC%94%E8%AE%B0/">
                                    <span class="chip bg-color">笔记</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'WuhAzlfLle9QnejVfhVJn3eg-MdYXbMMI',
        appKey: 'r0btSoHpzUv0WcNlFYweyR8e',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: '留下个足迹嘛!'
    });
</script>

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="../pi-chu-li/">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/24.jpg" class="responsive-img" alt="批处理笔记">
                        
                        <span class="card-title">批处理笔记</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            记录一下批处理的一些知识点,方便后续查看
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2019-10-15
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            ROOT
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="../../../../tags/Windows/">
                        <span class="chip bg-color">Windows</span>
                    </a>
                    
                    <a href="../../../../tags/%E7%BC%96%E7%A8%8B/">
                        <span class="chip bg-color">编程</span>
                    </a>
                    
                    <a href="../../../../tags/%E7%AC%94%E8%AE%B0/">
                        <span class="chip bg-color">笔记</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="../../../09/28/ru-he-zheng-que-dui-yong-hu-mi-ma-jin-xing-jia-mi/">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/22.jpg" class="responsive-img" alt="如何正确对用户密码进行加密">
                        
                        <span class="card-title">如何正确对用户密码进行加密</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            首先,贴上原文链接

https://www.infoq.cn/article/how-to-encrypt-the-user-password-correctly

感觉这篇文章写的很详细,这里做个笔记
哈希
保护密码的最好办法是使用加盐
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2019-09-28
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            ROOT
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="../../../../tags/%E5%AE%89%E5%85%A8/">
                        <span class="chip bg-color">安全</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>

    
<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    <style>
    canvas:not(#ribbon-canvas), #web_bg {
    margin-bottom: -0.5rem;
    display: block;
    width: 100%;
    height: 150px;

    }
</style>

<footer class="page-footer bg-color">
   
    <div class="container row center-align" style="margin-bottom">
        
        <div class="col s12 m8 l8 copy-right">
           
            <br>
            Copyright&nbsp;&copy;
            <a href="https://blog.bingfeng.ml" target="_blank">ROOT</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            <span id="icp"><img src="/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="https://google.com" target="_blank">备案,不存在的!</a>
            </span>
            <br>
            <br>
            苔痕上階綠，草色入簾青。談笑有鴻儒，往來無白丁。
            <br>可以調素琴，閱金經。無絲竹之亂耳，無案牘之勞形。
        </div>
        
            
        <div id="jsi-flying-fish-container" class="col s12 m4 l4 "></div>
        
       

       
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>
    <script src="/js/cursor.js"></script>
    <script src="/js/fish.js"></script>
   
    

    <!-- Global site tag (gtag.js) - Google Analytics -->


    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

    
    

    

    

    

    

    
    
    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    






</body>

</html>
